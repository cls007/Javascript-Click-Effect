var canvas,ctx,em1,conf={position:"emitter",velocity:{enableRandom:!0,upperBoundary:-2,LowerBoundary:2},acceleration:{x:0,y:.005},size:{enableRandom:!0,upperBoundary:4,LowerBoundary:1},color:{enableRandom:!0,upperBoundaryR:255,LowerBoundaryR:0,upperBoundaryG:255,LowerBoundaryG:0,upperBoundaryB:255,LowerBoundaryB:0},lifetime:{enableRandom:!0,upperBoundary:30,LowerBoundary:10}};function Vec2d(t,e){this.x=t||0,this.y=e||0}function vecpy(t){return new Vec2d(t.x,t.y)}function Particle(t,e,o,n,i,a){this.position=vecpy(t)||new Vec2d(0,0),this.velocity=vecpy(e)||new Vec2d(0,0),this.acceleration=vecpy(o)||new Vec2d(0,0),this.color=n||"rgb(0, 255, 0)",this.size=i||1,this.lifetime=a||10}function Emitter(t,e){this.position=vecpy(t),this.rate=e||1,this.particles=[],this.partConf={}}function isalive(t){return!(t.position.x>canvas.width||t.position.y>canvas.height||t.position.x+t.position.size<0||t.position.y+t.position.size<0||t.lifetime<=0)}function update(){for(var t=[],e=0;e<em1.particles.length;e++)isalive(em1.particles[e])&&(em1.particles[e].update(),em1.particles[e].draw(),t.push(em1.particles[e]));return em1.particles=t,t.length}function loop(){ctx.clearRect(0,0,canvas.width,canvas.height),0!==update()?window.requestAnimationFrame(loop):canvas&&(document.body.removeChild(canvas),canvas=void 0)}function clickEventHandle(t){canvas&&(document.body.removeChild(canvas),canvas=void 0),canvas=document.createElement("canvas"),ctx=canvas.getContext("2d"),canvas.width=100,canvas.height=100,canvas.style.backgroundColor="rgb(0, 0, 0, 0)",canvas.style.position="fixed",canvas.style.zIndex=77777777,canvas.style.pointerEvents="none";var e=t||window.event;canvas.style.left=(e.clientX-canvas.width/2).toString()+"px",canvas.style.top=(e.clientY-canvas.height/2).toString()+"px",document.body.appendChild(canvas),em1.setPartConf(conf),em1.emit(),loop()}Particle.prototype.update=function(){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.velocity.x+=this.acceleration.x,this.velocity.y+=this.acceleration.y,this.lifetime--},Particle.prototype.draw=function(){ctx.fillStyle=this.color,ctx.fillRect(this.position.x,this.position.y,this.size,this.size)},Emitter.prototype.setPartConf=function(t){this.partConf=t},Emitter.prototype.randomVec=function(t){return new Vec2d(Math.random()*(t.upperBoundary-t.LowerBoundary)+t.LowerBoundary,Math.random()*(t.upperBoundary-t.LowerBoundary)+t.LowerBoundary)},Emitter.prototype.randomColor=function(t){return"rgb("+Math.random()*(t.upperBoundaryR-t.LowerBoundaryR)+t.LowerBoundaryR+","+Math.random()*(t.upperBoundaryG-t.LowerBoundaryG)+t.LowerBoundaryG+","+Math.random()*(t.upperBoundaryB-t.LowerBoundaryB)+t.LowerBoundaryB+")"},Emitter.prototype.randomInRange=function(t){return Math.random()*(t.upperBoundary-t.LowerBoundary)+t.LowerBoundary},Emitter.prototype.createParticle=function(){var t,e,o,n;return t="emitter"==this.partConf.position?vecpy(this.position):vecpy(this.partConf.position),e=this.partConf.velocity.enableRandom?this.randomVec(this.partConf.velocity):new Vec2d(this.partConf.velocity.x,this.partConf.velocity.y),o=this.partConf.acceleration.enableRandom?this.randomVec(this.partConf.acceleration):new Vec2d(this.partConf.acceleration.x,this.partConf.acceleration.y),n=this.partConf.size.enableRandom?this.randomInRange(this.partConf.size):this.partConf.size.sideLength,new Particle(t,e,o,this.partConf.color.enableRandom?this.randomColor(this.partConf.color):this.partConf.color.rgb,n,this.partConf.lifetime.enableRandom?this.randomInRange(this.partConf.lifetime):this.partConf.lifetime.time)},Emitter.prototype.emit=function(){for(var t=0;t<this.rate;t++)this.particles.push(this.createParticle())},em1=new Emitter(new Vec2d(50,50),30),document.addEventListener("click",clickEventHandle);